<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Builder Workspace - Docking Station</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
            color: #00ff41;
            height: 100vh;
            overflow: hidden;
        }

        /* Main Workspace Layout */
        .workspace {
            display: grid;
            grid-template-columns: 250px 1fr 300px;
            grid-template-rows: 60px 1fr 50px;
            height: 100vh;
            gap: 2px;
            background: #000;
        }

        /* Top Bar - Project Info */
        .top-bar {
            grid-column: 1 / -1;
            background: rgba(0, 0, 0, 0.95);
            border-bottom: 2px solid #00ff41;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .project-info h1 {
            font-size: 20px;
            color: #00ff41;
        }

        .project-info .username {
            font-size: 12px;
            color: #888;
        }

        .ai-dock-indicator {
            display: flex;
            gap: 10px;
            align-items: center;
            font-size: 12px;
        }

        .ai-status {
            padding: 5px 10px;
            background: rgba(0, 255, 65, 0.1);
            border: 1px solid #00ff41;
            border-radius: 5px;
        }

        /* Left Sidebar - File Tree */
        .file-sidebar {
            background: rgba(0, 0, 0, 0.95);
            border-right: 2px solid #00ff41;
            padding: 20px;
            overflow-y: auto;
        }

        .file-sidebar h3 {
            margin-bottom: 15px;
            font-size: 14px;
            color: #00ff41;
            border-bottom: 1px solid #00ff41;
            padding-bottom: 10px;
        }

        .file-list {
            list-style: none;
        }

        .file-item {
            padding: 8px;
            margin-bottom: 5px;
            background: rgba(0, 255, 65, 0.05);
            border-left: 3px solid #00ff41;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.2s;
        }

        .file-item:hover {
            background: rgba(0, 255, 65, 0.15);
            transform: translateX(5px);
        }

        .file-item .file-icon {
            margin-right: 8px;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #666;
            font-size: 13px;
        }

        /* Center - Code/Preview Area */
        .code-area {
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            flex-direction: column;
        }

        .code-tabs {
            display: flex;
            gap: 2px;
            background: #000;
            padding: 10px 20px 0;
            border-bottom: 2px solid #00ff41;
        }

        .code-tab {
            padding: 10px 20px;
            background: rgba(0, 255, 65, 0.1);
            border: 1px solid #00ff41;
            border-bottom: none;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
        }

        .code-tab.active {
            background: rgba(0, 255, 65, 0.3);
        }

        .code-tab:hover {
            background: rgba(0, 255, 65, 0.2);
        }

        .code-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
        }

        .code-block {
            background: rgba(0, 255, 65, 0.05);
            border: 1px solid #00ff41;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 20px;
            position: relative;
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #00ff41;
        }

        .code-filename {
            color: #00ff41;
            font-weight: bold;
        }

        .copy-btn {
            background: none;
            border: 1px solid #00ff41;
            color: #00ff41;
            padding: 5px 15px;
            cursor: pointer;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 11px;
        }

        .copy-btn:hover {
            background: rgba(0, 255, 65, 0.2);
        }

        .code-preview {
            color: #aaa;
            white-space: pre-wrap;
        }

        /* Right Sidebar - AI Instructions Panel */
        .ai-panel {
            background: rgba(0, 0, 0, 0.95);
            border-left: 2px solid #00ff41;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .ai-panel h3 {
            margin-bottom: 15px;
            font-size: 14px;
            color: #00ff41;
            border-bottom: 1px solid #00ff41;
            padding-bottom: 10px;
        }

        .instruction-block {
            background: rgba(0, 255, 65, 0.1);
            border: 1px solid #00ff41;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 15px;
            font-size: 12px;
            line-height: 1.5;
        }

        .instruction-title {
            color: #00ff41;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .command-example {
            background: rgba(0, 0, 0, 0.5);
            border-left: 3px solid #ffff00;
            padding: 10px;
            margin-top: 10px;
            font-family: 'Courier New', monospace;
            color: #ffff00;
            font-size: 11px;
        }

        /* Bottom Bar - Quick Actions */
        .bottom-bar {
            grid-column: 1 / -1;
            background: rgba(0, 0, 0, 0.95);
            border-top: 2px solid #00ff41;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .quick-actions {
            display: flex;
            gap: 15px;
        }

        .action-btn {
            background: none;
            border: 1px solid #00ff41;
            color: #00ff41;
            padding: 8px 15px;
            cursor: pointer;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            transition: all 0.2s;
        }

        .action-btn:hover {
            background: rgba(0, 255, 65, 0.2);
            transform: translateY(-2px);
        }

        .action-btn.primary {
            background: #00ff41;
            color: #000;
        }

        .action-btn.primary:hover {
            background: #00ff66;
        }

        .workspace-status {
            font-size: 11px;
            color: #666;
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 255, 65, 0.05);
        }

        ::-webkit-scrollbar-thumb {
            background: #00ff41;
            border-radius: 4px;
        }

        /* Welcome splash for empty workspace */
        .welcome-splash {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
            padding: 40px;
        }

        .welcome-splash h2 {
            font-size: 32px;
            margin-bottom: 20px;
            color: #00ff41;
        }

        .welcome-splash p {
            font-size: 16px;
            color: #888;
            margin-bottom: 30px;
            max-width: 600px;
        }

        .welcome-splash .start-btn {
            background: #00ff41;
            color: #000;
            border: none;
            padding: 15px 40px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
        }

        .welcome-splash .start-btn:hover {
            background: #00ff66;
            transform: scale(1.05);
        }
    </style>
</head>
<body>
    <div class="workspace">
        <!-- Top Bar -->
        <div class="top-bar">
            <div class="project-info">
                <h1>üî® Builder Workspace</h1>
                <div class="username">Workspace: <span id="username">demo</span></div>
            </div>
            <div class="ai-dock-indicator">
                <div class="ai-status">üåÄ AI Docked</div>
                <div class="ai-status">üìÅ <span id="fileCount">0</span> Files</div>
            </div>
        </div>

        <!-- Left Sidebar - File Tree -->
        <div class="file-sidebar">
            <h3>üìÅ YOUR FILES</h3>
            <ul class="file-list" id="fileList">
                <li class="empty-state">No files yet.<br>Tell your AI to start building!</li>
            </ul>
        </div>

        <!-- Center - Code/Preview -->
        <div class="code-area">
            <div class="code-tabs">
                <div class="code-tab active">üìù Code</div>
                <div class="code-tab">üëÅÔ∏è Preview</div>
                <div class="code-tab">üìã Instructions</div>
            </div>
            <div class="code-content" id="codeContent">
                <div class="welcome-splash">
                    <h2>Welcome to Your Builder Workspace</h2>
                    <p>This is your docking station. Use ANY AI assistant you prefer to build here.</p>
                    <p>Your AI already knows how to create files - just ask it to build something!</p>
                    <button class="start-btn" onclick="showInstructions()">See How It Works ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Right Sidebar - AI Instructions -->
        <div class="ai-panel">
            <h3>üí° HOW TO USE</h3>

            <div class="instruction-block">
                <div class="instruction-title">1. Bring Your AI</div>
                Use Araya, ChatGPT, Claude, or ANY AI assistant you already have.
            </div>

            <div class="instruction-block">
                <div class="instruction-title">2. Tell It What To Build</div>
                Your AI knows how to create files in this workspace.
                <div class="command-example">
                    "Build me a landing page for my coffee shop"
                </div>
            </div>

            <div class="instruction-block">
                <div class="instruction-title">3. Files Appear Here</div>
                Watch your project come to life in real-time as your AI builds it.
            </div>

            <div class="instruction-block">
                <div class="instruction-title">4. Download & Deploy</div>
                When ready, download your files or deploy directly.
            </div>

            <div class="instruction-block" style="background: rgba(255, 255, 0, 0.1); border-color: #ffff00;">
                <div class="instruction-title" style="color: #ffff00;">üåÄ Using Araya?</div>
                Just open your Araya panel and say:<br>
                <div class="command-example">
                    "Let's build a website in my workspace"
                </div>
            </div>
        </div>

        <!-- Bottom Bar -->
        <div class="bottom-bar">
            <div class="quick-actions">
                <button class="action-btn" onclick="refreshWorkspace()">üîÑ Refresh</button>
                <button class="action-btn" onclick="clearWorkspace()">üóëÔ∏è Clear</button>
                <button class="action-btn primary" onclick="downloadAll()">‚¨áÔ∏è Download All</button>
            </div>
            <div class="workspace-status">
                Ready to build | API: <span style="color: #00ff41;">‚óè</span> Connected
            </div>
        </div>
    </div>

    <script>
        // Configuration
        const API_BASE = 'http://localhost:8004';
        const username = new URLSearchParams(window.location.search).get('user') || 'demo';
        document.getElementById('username').textContent = username;

        // Load workspace files
        async function refreshWorkspace() {
            try {
                const response = await fetch(`${API_BASE}/api/workspace/${username}`);
                const data = await response.json();

                displayFiles(data.files || []);
                document.getElementById('fileCount').textContent = data.files?.length || 0;
            } catch (error) {
                console.error('Error loading workspace:', error);
            }
        }

        // Display files in sidebar
        function displayFiles(files) {
            const fileList = document.getElementById('fileList');

            if (files.length === 0) {
                fileList.innerHTML = '<li class="empty-state">No files yet.<br>Tell your AI to start building!</li>';
                return;
            }

            fileList.innerHTML = files.map(file => `
                <li class="file-item" onclick="viewFile('${file.filename}')">
                    <span class="file-icon">üìÑ</span>
                    ${file.filename}
                </li>
            `).join('');
        }

        // View a specific file
        async function viewFile(filename) {
            try {
                const response = await fetch(`${API_BASE}/api/read/${username}/${filename}`);
                const data = await response.json();

                const codeContent = document.getElementById('codeContent');
                codeContent.innerHTML = `
                    <div class="code-block">
                        <div class="code-header">
                            <div class="code-filename">${filename}</div>
                            <button class="copy-btn" onclick="copyCode('${filename}')">Copy</button>
                        </div>
                        <div class="code-preview">${escapeHtml(data.content)}</div>
                    </div>
                `;
            } catch (error) {
                console.error('Error reading file:', error);
            }
        }

        // Helper functions
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function copyCode(filename) {
            // Copy to clipboard implementation
            alert(`Copied ${filename} to clipboard!`);
        }

        function clearWorkspace() {
            if (confirm('Clear all files? This cannot be undone.')) {
                // Implementation
                alert('Workspace cleared');
                refreshWorkspace();
            }
        }

        function downloadAll() {
            alert('Downloading all files...');
            // Implementation
        }

        function showInstructions() {
            const codeContent = document.getElementById('codeContent');
            codeContent.innerHTML = `
                <div class="code-block">
                    <div class="code-header">
                        <div class="code-filename">Getting Started</div>
                    </div>
                    <div class="code-preview">
Ready to build? Here's how:

1. Open your AI assistant (Araya, ChatGPT, Claude, etc.)

2. Tell it what you want to build:
   "Create a portfolio website"
   "Build a landing page for my business"
   "Make a simple calculator app"

3. Your AI will create files in this workspace

4. Watch them appear in the file list on the left

5. Click any file to view or edit it

6. When done, download or deploy your project

That's it! Your workspace is ready.
                    </div>
                </div>
            `;
        }

        // Auto-refresh every 5 seconds to catch new files
        setInterval(refreshWorkspace, 5000);

        // Initial load
        refreshWorkspace();

        console.log('üî® Builder Workspace Docking Station Ready');
        console.log('Workspace:', username);
    </script>

<!-- üéÆ UNIVERSAL HUD - Auto-injected -->
<script src="/universal-hud-embed.js"></script>

<!-- üÜò UNIVERSAL HELP SYSTEM + BUG NOTEPAD üÜò -->
<script src="/UNIVERSAL_HELP_SYSTEM.js"></script>
<script src="/UNIVERSAL_BUG_NOTEPAD_V2.js"></script>
    <script>

            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `bug_${Date.now()}.json`;
            a.click();
        });

        // Show success message
        alert('‚úÖ BUG REPORTED!\n\nThanks for reporting this bug. We check reports every couple hours and will fix it ASAP.\n\nYour feedback makes the platform better!');

        // Reset form
        document.getElementById('bug-report-form').reset();
        toggleBugPanel();
    };
})();
</script>


    <script src="UNIVERSAL_ANALYTICS_TRACKER.js"></script>
</body> tag -->




    <!-- Simple Bug Reporter -->
    <script src="/SIMPLE_BUG_REPORTER.js"></script>

    <script src="/UNIVERSAL_USER_DISPLAY.js"></script>
    <script src="UNIVERSAL_ANALYTICS_TRACKER.js"></script>
</body>
</html>
