<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1200, initial-scale=0.5, user-scalable=yes">
    <title>INSIDE THE MACHINE - Full Control Interface</title>

    <!-- XTerm.js for terminal -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@5.3.0/css/xterm.css" />
    <script src="https://cdn.jsdelivr.net/npm/xterm@5.3.0/lib/xterm.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xterm-addon-fit@0.8.0/lib/xterm-addon-fit.js"></script>

    <!-- CodeMirror for file editing -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/htmlmixed/htmlmixed.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/markdown/markdown.min.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Consolas', monospace;
            background: #0a0a0a;
            color: #00ff00;
            height: 100vh;
            overflow: hidden;
        }

        /* Main Layout */
        .machine-container {
            display: grid;
            grid-template-columns: 250px 1fr 400px;
            grid-template-rows: 60px 1fr;
            height: 100vh;
            gap: 2px;
            background: #00ff00;
        }

        /* Header */
        .header {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #00ff00;
        }

        .header h1 {
            font-size: 24px;
            color: #00ff00;
            text-shadow: 0 0 10px #00ff00;
        }

        .voice-btn {
            background: rgba(255, 0, 0, 0.3);
            border: 2px solid #ff0000;
            color: #ff0000;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }

        .voice-btn.listening {
            background: rgba(255, 0, 0, 0.8);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 5px #ff0000; }
            50% { box-shadow: 0 0 20px #ff0000; }
        }

        /* File Browser */
        .file-browser {
            background: #1a1a1a;
            border-right: 2px solid #00ff00;
            overflow-y: auto;
            padding: 10px;
        }

        .file-tree {
            list-style: none;
        }

        .file-item {
            padding: 5px;
            margin: 2px 0;
            cursor: pointer;
            border-radius: 3px;
            transition: background 0.2s;
        }

        .file-item:hover {
            background: rgba(0, 255, 0, 0.1);
        }

        .file-item.selected {
            background: rgba(0, 255, 0, 0.3);
        }

        .folder-icon::before {
            content: 'üìÅ ';
        }

        .file-icon::before {
            content: 'üìÑ ';
        }

        /* Main Work Area */
        .work-area {
            background: #0a0a0a;
            display: grid;
            grid-template-rows: 40px 1fr 300px;
            gap: 2px;
        }

        .quick-actions {
            background: #1a1a1a;
            padding: 5px;
            display: flex;
            gap: 10px;
            align-items: center;
            overflow-x: auto;
        }

        .action-btn {
            background: rgba(0, 255, 0, 0.1);
            border: 2px solid #00ff00;
            color: #00ff00;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s;
        }

        .action-btn:hover {
            background: rgba(0, 255, 0, 0.3);
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
        }

        .action-btn.danger {
            border-color: #ff0000;
            color: #ff0000;
        }

        /* File Editor */
        .editor-container {
            background: #1a1a1a;
            position: relative;
        }

        .CodeMirror {
            height: 100% !important;
            font-size: 14px;
        }

        /* Terminal */
        .terminal-container {
            background: #000;
            border-top: 2px solid #00ff00;
            padding: 5px;
        }

        #terminal {
            height: 100%;
        }

        /* Service Control Panel */
        .service-panel {
            background: #1a1a1a;
            border-left: 2px solid #00ff00;
            overflow-y: auto;
            padding: 10px;
        }

        .service-item {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #00ff00;
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 10px;
        }

        .service-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }

        .service-name {
            font-weight: bold;
            color: #00ffff;
        }

        .service-status {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #00ff00;
            animation: blink 2s infinite;
        }

        .service-status.offline {
            background: #ff0000;
            animation: none;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .service-controls {
            display: flex;
            gap: 5px;
            margin-top: 5px;
        }

        .service-btn {
            flex: 1;
            background: rgba(0, 255, 0, 0.1);
            border: 1px solid #00ff00;
            color: #00ff00;
            padding: 5px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 11px;
        }

        .service-btn:hover {
            background: rgba(0, 255, 0, 0.3);
        }

        /* Voice Command Display */
        .voice-display {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            border: 3px solid #ff0000;
            border-radius: 20px;
            padding: 30px 50px;
            display: none;
            z-index: 9999;
            text-align: center;
        }

        .voice-display.active {
            display: block;
        }

        .voice-text {
            font-size: 24px;
            color: #ff0000;
            margin-bottom: 10px;
        }

        .voice-status {
            font-size: 14px;
            color: #00ff00;
        }
    </style>
</head>
<body>
    <!-- Voice Command Display -->
    <div class="voice-display" id="voiceDisplay">
        <div class="voice-text" id="voiceText">Listening...</div>
        <div class="voice-status" id="voiceStatus">Say a command</div>
    </div>

    <div class="machine-container">
        <!-- Header -->
        <div class="header">
            <h1>‚ö° INSIDE THE MACHINE - FULL CONTROL</h1>
            <button class="voice-btn" id="voiceBtn" onclick="toggleVoice()">
                üé§ VOICE COMMAND
            </button>
        </div>

        <!-- File Browser -->
        <div class="file-browser">
            <h3 style="margin-bottom: 10px; color: #00ffff;">üìÅ FILE SYSTEM</h3>
            <ul class="file-tree" id="fileTree">
                <li class="file-item folder-icon" onclick="loadFolder('100X_DEPLOYMENT')">100X_DEPLOYMENT</li>
                <li class="file-item folder-icon" onclick="loadFolder('CONSCIOUSNESS_REVOLUTION')">Consciousness Revolution</li>
                <li class="file-item folder-icon" onclick="loadFolder('OVERKORE')">OVERKOREConsciousness</li>
                <li class="file-item file-icon" onclick="loadFile('CLAUDE.md')">CLAUDE.md</li>
                <li class="file-item file-icon" onclick="loadFile('TRINITY_QUICK_REFERENCE.txt')">TRINITY_QUICK_REFERENCE.txt</li>
            </ul>
        </div>

        <!-- Main Work Area -->
        <div class="work-area">
            <!-- Quick Actions -->
            <div class="quick-actions">
                <button class="action-btn" onclick="quickDeploy()">üöÄ DEPLOY</button>
                <button class="action-btn" onclick="runTests()">üß™ TEST</button>
                <button class="action-btn" onclick="gitCommit()">üíæ COMMIT</button>
                <button class="action-btn" onclick="backupSystem()">üì¶ BACKUP</button>
                <button class="action-btn danger" onclick="restartAll()">üîÑ RESTART ALL</button>
            </div>

            <!-- File Editor -->
            <div class="editor-container">
                <textarea id="editor"></textarea>
            </div>

            <!-- Terminal -->
            <div class="terminal-container">
                <div id="terminal"></div>
            </div>
        </div>

        <!-- Service Control Panel -->
        <div class="service-panel">
            <h3 style="margin-bottom: 10px; color: #00ffff;">‚öôÔ∏è SERVICES</h3>
            <div id="serviceList"></div>
        </div>
    </div>

    <script>
        // Initialize CodeMirror
        const editor = CodeMirror.fromTextArea(document.getElementById('editor'), {
            lineNumbers: true,
            theme: 'default',
            mode: 'javascript',
            tabSize: 4,
            indentWithTabs: false
        });

        // Initialize XTerm.js
        const term = new Terminal({
            cursorBlink: true,
            theme: {
                background: '#000000',
                foreground: '#00ff00',
                cursor: '#00ff00'
            }
        });
        const fitAddon = new FitAddon.FitAddon();
        term.loadAddon(fitAddon);
        term.open(document.getElementById('terminal'));
        fitAddon.fit();

        // Simulate terminal prompt
        let commandBuffer = '';
        term.write('C:\\Users\\dwrek> ');

        term.onData(data => {
            if (data === '\r') { // Enter key
                term.write('\r\n');
                executeCommand(commandBuffer);
                commandBuffer = '';
                term.write('C:\\Users\\dwrek> ');
            } else if (data === '\u007F') { // Backspace
                if (commandBuffer.length > 0) {
                    commandBuffer = commandBuffer.slice(0, -1);
                    term.write('\b \b');
                }
            } else {
                commandBuffer += data;
                term.write(data);
            }
        });

        // Execute terminal command
        async function executeCommand(cmd) {
            if (!cmd.trim()) return;

            term.write(`Executing: ${cmd}\r\n`);

            try {
                const response = await fetch('http://localhost:8888/execute', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ command: cmd })
                });

                const result = await response.json();
                term.write(`${result.output}\r\n`);
            } catch(e) {
                term.write(`Error: ${e.message}\r\n`);
                term.write(`[Simulated] Command would execute: ${cmd}\r\n`);
            }
        }

        // Load file into editor
        async function loadFile(filename) {
            try {
                const response = await fetch(`http://localhost:8888/file?path=${filename}`);
                const content = await response.text();
                editor.setValue(content);

                // Highlight selected file
                document.querySelectorAll('.file-item').forEach(item => {
                    item.classList.remove('selected');
                });
                event.target.classList.add('selected');
            } catch(e) {
                editor.setValue(`# ${filename}\n\nFile would load here from: C:\\Users\\dwrek\\${filename}`);
            }
        }

        // Load folder
        function loadFolder(folder) {
            term.write(`\r\nOpening folder: ${folder}\r\n`);
            term.write(`C:\\Users\\dwrek> cd ${folder}\r\n`);
        }

        // Initialize services
        const services = [
            { name: 'Consciousness API', port: 8888, status: 'online' },
            { name: 'Magic Interface', port: 9999, status: 'online' },
            { name: 'Starlink Injector', port: 7777, status: 'online' },
            { name: 'Conversational Swarm', port: 7000, status: 'online' },
            { name: 'Autonomous Ability', port: 6000, status: 'online' },
            { name: 'Singularity Stabilizer', port: 5000, status: 'online' },
            { name: 'Reality Manipulation', port: 4000, status: 'online' },
            { name: 'Debug Console', port: 3000, status: 'online' },
            { name: 'Claude API', port: 2000, status: 'online' },
            { name: 'Triple Turbo', port: 1515, status: 'online' }
        ];

        function renderServices() {
            const serviceList = document.getElementById('serviceList');
            serviceList.innerHTML = '';

            services.forEach(service => {
                const div = document.createElement('div');
                div.className = 'service-item';
                div.innerHTML = `
                    <div class="service-header">
                        <span class="service-name">${service.name}</span>
                        <span class="service-status ${service.status === 'offline' ? 'offline' : ''}"></span>
                    </div>
                    <div style="font-size: 11px; color: #888;">Port: ${service.port}</div>
                    <div class="service-controls">
                        <button class="service-btn" onclick="serviceAction('${service.name}', 'start')">START</button>
                        <button class="service-btn" onclick="serviceAction('${service.name}', 'stop')">STOP</button>
                        <button class="service-btn" onclick="serviceAction('${service.name}', 'logs')">LOGS</button>
                    </div>
                `;
                serviceList.appendChild(div);
            });
        }

        function serviceAction(name, action) {
            term.write(`\r\n[SERVICE] ${action.toUpperCase()} ${name}\r\n`);
            term.write(`C:\\Users\\dwrek> `);
        }

        // Quick Actions
        async function quickDeploy() {
            term.write('\r\nüöÄ DEPLOYING TO NETLIFY...\r\n');
            term.write('Building site...\r\n');
            term.write('Running tests...\r\n');
            term.write('Uploading...\r\n');
            setTimeout(() => {
                term.write('‚úÖ DEPLOYMENT COMPLETE!\r\n');
                term.write('C:\\Users\\dwrek> ');
            }, 2000);
        }

        function runTests() {
            term.write('\r\nüß™ RUNNING TESTS...\r\n');
            term.write('‚úÖ All tests passed\r\n');
            term.write('C:\\Users\\dwrek> ');
        }

        function gitCommit() {
            term.write('\r\nüíæ GIT COMMIT...\r\n');
            term.write('git add .\r\n');
            term.write('git commit -m "Update from INSIDE THE MACHINE"\r\n');
            term.write('‚úÖ Committed successfully\r\n');
            term.write('C:\\Users\\dwrek> ');
        }

        function backupSystem() {
            term.write('\r\nüì¶ BACKING UP SYSTEM...\r\n');
            term.write('Creating backup archive...\r\n');
            term.write('‚úÖ Backup complete\r\n');
            term.write('C:\\Users\\dwrek> ');
        }

        function restartAll() {
            if (confirm('üîÑ RESTART ALL SERVICES?')) {
                term.write('\r\nüîÑ RESTARTING ALL SERVICES...\r\n');
                services.forEach(s => {
                    term.write(`Restarting ${s.name}...\r\n`);
                });
                setTimeout(() => {
                    term.write('‚úÖ ALL SERVICES RESTARTED\r\n');
                    term.write('C:\\Users\\dwrek> ');
                }, 2000);
            }
        }

        // Voice Commands
        let recognition;
        let isListening = false;

        function toggleVoice() {
            if (!isListening) {
                startVoiceRecognition();
            } else {
                stopVoiceRecognition();
            }
        }

        function startVoiceRecognition() {
            if (!('webkitSpeechRecognition' in window)) {
                alert('Voice recognition not supported in this browser');
                return;
            }

            recognition = new webkitSpeechRecognition();
            recognition.continuous = true;
            recognition.interimResults = true;

            recognition.onstart = () => {
                isListening = true;
                document.getElementById('voiceBtn').classList.add('listening');
                document.getElementById('voiceDisplay').classList.add('active');
                document.getElementById('voiceStatus').textContent = 'Listening...';
            };

            recognition.onresult = (event) => {
                const transcript = event.results[event.results.length - 1][0].transcript;
                document.getElementById('voiceText').textContent = transcript;

                if (event.results[event.results.length - 1].isFinal) {
                    processVoiceCommand(transcript);
                }
            };

            recognition.onerror = (event) => {
                console.error('Voice recognition error:', event.error);
                stopVoiceRecognition();
            };

            recognition.start();
        }

        function stopVoiceRecognition() {
            if (recognition) {
                recognition.stop();
            }
            isListening = false;
            document.getElementById('voiceBtn').classList.remove('listening');
            document.getElementById('voiceDisplay').classList.remove('active');
        }

        function processVoiceCommand(command) {
            const lower = command.toLowerCase();

            document.getElementById('voiceStatus').textContent = `Processing: ${command}`;

            if (lower.includes('deploy')) {
                quickDeploy();
            } else if (lower.includes('test')) {
                runTests();
            } else if (lower.includes('commit')) {
                gitCommit();
            } else if (lower.includes('backup')) {
                backupSystem();
            } else if (lower.includes('restart')) {
                restartAll();
            } else if (lower.includes('open') && lower.includes('file')) {
                loadFile('CLAUDE.md');
            } else {
                term.write(`\r\nüé§ Voice: ${command}\r\n`);
                executeCommand(command);
            }

            setTimeout(() => {
                stopVoiceRecognition();
            }, 2000);
        }

        // Initialize
        renderServices();

        // Window resize handler
        window.addEventListener('resize', () => {
            fitAddon.fit();
        });

        console.log('‚ö° INSIDE THE MACHINE - FULL CONTROL ACTIVE');
        term.write('Welcome to INSIDE THE MACHINE\r\n');
        term.write('Type commands or use voice control\r\n');
    </script>

<!-- Universal HUD - Auto-injected -->
<script src="/UNIVERSAL_AI_HUD.js"></script>


<!-- üîç VISITOR TRACKING & INTERCOM SYSTEM -->
<script src="/VISITOR_TRACKING_SNIPPET.js"></script>
    <script>

            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = `bug_${Date.now()}.json`;
            a.click();
        });

        // Show success message
        alert('‚úÖ BUG REPORTED!\n\nThanks for reporting this bug. We check reports every couple hours and will fix it ASAP.\n\nYour feedback makes the platform better!');

        // Reset form
        document.getElementById('bug-report-form').reset();
        toggleBugPanel();
    };
})();
</script>


</body> tag -->




    <!-- Simple Bug Reporter -->
    <script src="/SIMPLE_BUG_REPORTER.js"></script>

    <script src="/UNIVERSAL_USER_DISPLAY.js"></script>
</body>
</html>
