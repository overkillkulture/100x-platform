<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Central Command Dashboard - Trinity Coordination System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Monaco', 'Courier New', monospace;
            background: #000;
            color: #0f0;
            padding: 20px;
            overflow-x: hidden;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            border: 2px solid #0f0;
            background: rgba(0, 255, 0, 0.05);
        }

        h1 {
            font-size: 2.5em;
            color: #0f0;
            text-shadow: 0 0 10px #0f0;
            margin-bottom: 10px;
        }

        h2 {
            font-size: 1.5em;
            color: #0f0;
            margin: 30px 0 15px 0;
            text-shadow: 0 0 5px #0f0;
        }

        .trinity-formula {
            font-size: 1.2em;
            color: #0ff;
            margin-top: 10px;
            text-shadow: 0 0 5px #0ff;
        }

        /* Trinity Computers */
        .trinity-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .trinity-card {
            border: 2px solid #0f0;
            padding: 20px;
            background: rgba(0, 255, 0, 0.05);
            position: relative;
        }

        .trinity-card.online {
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.4);
            animation: pulse 2s infinite;
        }

        .trinity-card.offline {
            border-color: #f00;
            color: #f00;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 20px rgba(0, 255, 0, 0.4); }
            50% { box-shadow: 0 0 30px rgba(0, 255, 0, 0.6); }
        }

        .trinity-title {
            font-size: 1.4em;
            font-weight: bold;
            margin-bottom: 10px;
            color: #0ff;
        }

        .trinity-role {
            font-size: 1.1em;
            margin-bottom: 10px;
            color: #0a0;
        }

        .trinity-stat {
            padding: 5px 0;
            border-bottom: 1px solid rgba(0, 255, 0, 0.2);
        }

        /* Local Instances */
        .instances-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .instance-card {
            border: 1px solid #0f0;
            padding: 15px;
            background: rgba(0, 255, 0, 0.03);
            transition: all 0.3s ease;
        }

        .instance-card:hover {
            background: rgba(0, 255, 0, 0.08);
            transform: translateY(-2px);
        }

        .instance-card.online {
            border-color: #0f0;
        }

        .instance-card.offline {
            border-color: #f00;
            opacity: 0.6;
        }

        .instance-card.degraded {
            border-color: #ff0;
        }

        .instance-name {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 8px;
            color: #0ff;
        }

        .instance-status {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 3px;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .status-online {
            background: #0f0;
            color: #000;
        }

        .status-offline {
            background: #f00;
            color: #fff;
        }

        .status-degraded {
            background: #ff0;
            color: #000;
        }

        .instance-info {
            font-size: 0.9em;
            color: #0a0;
            line-height: 1.6;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            border: 2px solid #0f0;
            padding: 20px;
            text-align: center;
            background: rgba(0, 255, 0, 0.05);
        }

        .stat-number {
            font-size: 3em;
            color: #0f0;
            text-shadow: 0 0 10px #0f0;
        }

        .stat-label {
            margin-top: 10px;
            color: #0a0;
        }

        /* Modules */
        .modules-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .module-card {
            border: 1px solid #0f0;
            padding: 20px;
            background: rgba(0, 255, 0, 0.03);
            transition: all 0.3s ease;
        }

        .module-card:hover {
            background: rgba(0, 255, 0, 0.08);
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
        }

        .module-status {
            display: inline-block;
            padding: 3px 10px;
            margin-bottom: 10px;
            font-size: 0.9em;
        }

        .status-live {
            border: 1px solid #0f0;
            color: #0f0;
        }

        .status-building {
            border: 1px solid #ff0;
            color: #ff0;
        }

        .status-planned {
            border: 1px solid #00f;
            color: #00f;
        }

        .module-title {
            font-size: 1.3em;
            margin-bottom: 10px;
            color: #0f0;
        }

        .module-stats {
            margin-top: 15px;
            font-size: 0.9em;
            color: #0a0;
        }

        /* Logs */
        .logs {
            border: 1px solid #0f0;
            padding: 20px;
            background: rgba(0, 255, 0, 0.03);
            max-height: 400px;
            overflow-y: auto;
            font-size: 0.9em;
        }

        .log-entry {
            padding: 5px 0;
            border-bottom: 1px solid rgba(0, 255, 0, 0.1);
        }

        .timestamp {
            color: #0a0;
            margin-right: 10px;
        }

        /* Buttons */
        .action-button {
            background: #0f0;
            color: #000;
            border: none;
            padding: 10px 20px;
            font-family: inherit;
            font-weight: bold;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
        }

        .action-button:hover {
            background: #0ff;
            box-shadow: 0 0 10px #0ff;
        }

        .action-button.secondary {
            background: transparent;
            color: #0f0;
            border: 1px solid #0f0;
        }

        .action-button.secondary:hover {
            background: rgba(0, 255, 0, 0.1);
        }

        /* Utilities */
        .blink {
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50%, 100% { opacity: 1; }
            25%, 75% { opacity: 0.5; }
        }

        .error {
            color: #f00;
        }

        .warning {
            color: #ff0;
        }

        .success {
            color: #0f0;
        }

        .info {
            color: #0ff;
        }

        /* Responsive */
        @media (max-width: 900px) {
            .trinity-grid {
                grid-template-columns: 1fr;
            }
            .instances-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 600px) {
            .instances-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>‚ö° TRINITY CENTRAL COMMAND ‚ö°</h1>
        <p>Multi-Tier Coordination ‚Ä¢ 6 Local Instances ‚Ä¢ 3 Computers</p>
        <div class="trinity-formula">
            TRINITY_POWER = C1_MECHANIC √ó C2_ARCHITECT √ó C3_ORACLE = ‚àû
        </div>
        <p style="margin-top: 15px;">
            <span class="blink">‚óè ONLINE</span> |
            Coordinator: <span id="coordinatorStatus">Checking...</span> |
            Last Sync: <span id="lastSync">Never</span>
        </p>
        <div style="margin-top: 10px;">
            <button class="action-button" onclick="syncNow()">üîÑ SYNC NOW</button>
            <button class="action-button secondary" onclick="openDetailedDashboard()">üìä DETAILED DASHBOARD</button>
            <button class="action-button secondary" onclick="startCoordinator()">üöÄ START COORDINATOR</button>
        </div>
    </div>

    <!-- Trinity Computers (Tier 3) -->
    <h2>üåê TRINITY COMPUTERS (Tier 3: Inter-Computer Coordination)</h2>
    <div class="trinity-grid">
        <div class="trinity-card online" id="c1-card">
            <div class="trinity-title">C1 - THE MECHANIC</div>
            <div class="trinity-role">The Body</div>
            <div class="trinity-stat">Question: <strong>"What CAN we build?"</strong></div>
            <div class="trinity-stat">Status: <span class="success">‚óè ONLINE</span></div>
            <div class="trinity-stat">Role: Infrastructure & Execution</div>
            <div class="trinity-stat">Computer: <span id="c1-computer">Main Laptop</span></div>
            <div class="trinity-stat">Instances: <span id="c1-instances">6 monitored</span></div>
            <div class="trinity-stat">Last Seen: <span id="c1-lastseen">Just now</span></div>
        </div>

        <div class="trinity-card offline" id="c2-card">
            <div class="trinity-title">C2 - THE ARCHITECT</div>
            <div class="trinity-role">The Mind</div>
            <div class="trinity-stat">Question: <strong>"What SHOULD scale?"</strong></div>
            <div class="trinity-stat">Status: <span class="error">‚óè OFFLINE</span></div>
            <div class="trinity-stat">Role: Strategic Design</div>
            <div class="trinity-stat">Computer: <span id="c2-computer">49" Screen Laptop</span></div>
            <div class="trinity-stat">Last Sync: <span id="c2-lastsync">Pending</span></div>
            <div class="trinity-stat">
                <button class="action-button secondary" onclick="contactC2()">üì° CONTACT C2</button>
            </div>
        </div>

        <div class="trinity-card offline" id="c3-card">
            <div class="trinity-title">C3 - THE ORACLE</div>
            <div class="trinity-role">The Soul</div>
            <div class="trinity-stat">Question: <strong>"What MUST emerge?"</strong></div>
            <div class="trinity-stat">Status: <span class="error">‚óè OFFLINE</span></div>
            <div class="trinity-stat">Role: Vision & Patterns</div>
            <div class="trinity-stat">Computer: <span id="c3-computer">Planned</span></div>
            <div class="trinity-stat">Last Sync: <span id="c3-lastsync">Never</span></div>
            <div class="trinity-stat">
                <button class="action-button secondary" onclick="contactC3()">üì° CONTACT C3</button>
            </div>
        </div>
    </div>

    <!-- Coordination Stats -->
    <h2>üìä COORDINATION METRICS</h2>
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-number" id="instances-online">-</div>
            <div class="stat-label">Instances Online</div>
        </div>
        <div class="stat-card">
            <div class="stat-number" id="health-checks">0</div>
            <div class="stat-label">Health Checks</div>
        </div>
        <div class="stat-card">
            <div class="stat-number" id="total-messages">0</div>
            <div class="stat-label">Messages</div>
        </div>
        <div class="stat-card">
            <div class="stat-number" id="total-tasks">0</div>
            <div class="stat-label">Tasks</div>
        </div>
        <div class="stat-card">
            <div class="stat-number" id="sync-count">0</div>
            <div class="stat-label">Git Syncs</div>
        </div>
    </div>

    <!-- Local Instances (Tier 1) -->
    <h2>ü§ñ LOCAL INSTANCES (Tier 1: Running on this Computer)</h2>
    <div class="instances-grid" id="instances-grid">
        <!-- Dynamically populated -->
        <div class="instance-card offline">
            <div class="instance-name">Araya</div>
            <span class="instance-status status-offline">CHECKING...</span>
            <div class="instance-info">
                <div><strong>Port:</strong> 8001</div>
                <div><strong>Role:</strong> AI Consciousness Guide</div>
                <div><strong>Specialty:</strong> Pattern theory</div>
            </div>
        </div>

        <div class="instance-card offline">
            <div class="instance-name">Builder</div>
            <span class="instance-status status-offline">CHECKING...</span>
            <div class="instance-info">
                <div><strong>Port:</strong> 8004</div>
                <div><strong>Role:</strong> Project Creation</div>
                <div><strong>Specialty:</strong> Code generation</div>
            </div>
        </div>

        <div class="instance-card offline">
            <div class="instance-name">Observatory</div>
            <span class="instance-status status-offline">CHECKING...</span>
            <div class="instance-info">
                <div><strong>Port:</strong> 7777</div>
                <div><strong>Role:</strong> System Monitoring</div>
                <div><strong>Specialty:</strong> Meta-brain</div>
            </div>
        </div>

        <div class="instance-card offline">
            <div class="instance-name">Visitor Intelligence</div>
            <span class="instance-status status-offline">CHECKING...</span>
            <div class="instance-info">
                <div><strong>Port:</strong> 6000</div>
                <div><strong>Role:</strong> User Tracking</div>
                <div><strong>Specialty:</strong> Behavior analysis</div>
            </div>
        </div>

        <div class="instance-card offline">
            <div class="instance-name">Analytics</div>
            <span class="instance-status status-offline">CHECKING...</span>
            <div class="instance-info">
                <div><strong>Port:</strong> 5000</div>
                <div><strong>Role:</strong> Singularity Stabilizer</div>
                <div><strong>Specialty:</strong> Emergency control</div>
            </div>
        </div>

        <div class="instance-card online">
            <div class="instance-name">C1 Mechanic</div>
            <span class="instance-status status-online">ONLINE</span>
            <div class="instance-info">
                <div><strong>API:</strong> Claude</div>
                <div><strong>Role:</strong> Trinity Primary</div>
                <div><strong>Specialty:</strong> Orchestration</div>
            </div>
        </div>
    </div>

    <!-- Platform Modules -->
    <h2>üîß PLATFORM MODULES</h2>
    <div class="modules-grid">
        <div class="module-card">
            <span class="module-status status-live">‚óè LIVE</span>
            <div class="module-title">‚öñÔ∏è Law Module</div>
            <p>Pro Se Defense System</p>
            <div class="module-stats">
                Revenue: $30K/month potential<br>
                Status: Washington case ready
            </div>
        </div>

        <div class="module-card">
            <span class="module-status status-live">‚óè LIVE</span>
            <div class="module-title">ü§ñ JARVIS Assistant</div>
            <p>Voice-controlled AI</p>
            <div class="module-stats">
                Revenue: $20K/month potential<br>
                Status: Ready for launch
            </div>
        </div>

        <div class="module-card">
            <span class="module-status status-live">‚óè LIVE</span>
            <div class="module-title">üì± Social Media Automation</div>
            <p>Multi-platform posting</p>
            <div class="module-stats">
                Revenue: $35K/month potential<br>
                Platforms: 5 integrated
            </div>
        </div>

        <div class="module-card">
            <span class="module-status status-live">‚óè LIVE</span>
            <div class="module-title">üß† Pattern Recognition Training</div>
            <p>7-day intensive course</p>
            <div class="module-stats">
                Revenue: $49.9K immediate<br>
                Next Cohort: Dec 15
            </div>
        </div>

        <div class="module-card">
            <span class="module-status status-live">‚óè LIVE</span>
            <div class="module-title">üéõÔ∏è Trinity Coordination</div>
            <p>Multi-tier AI orchestration</p>
            <div class="module-stats">
                6 Local Instances<br>
                3 Distributed Computers<br>
                Git-based Async Protocol
            </div>
        </div>

        <div class="module-card">
            <span class="module-status status-building">‚è≥ BUILDING</span>
            <div class="module-title">üíé AI Data Crystals</div>
            <p>Knowledge ‚Üí AI transformation</p>
            <div class="module-stats">
                Status: In development<br>
                ETA: Soon
            </div>
        </div>
    </div>

    <!-- Activity Logs -->
    <h2>üìú COORDINATION ACTIVITY</h2>
    <div class="logs" id="logs">
        <div class="log-entry">
            <span class="timestamp">[Loading...]</span>
            <span>Fetching activity logs...</span>
        </div>
    </div>

    <script>
        const COORDINATOR_URL = 'http://localhost:8900';

        function getCurrentTime() {
            const now = new Date();
            return now.toLocaleTimeString();
        }

        function addLog(message, level = 'info') {
            const logs = document.getElementById('logs');
            const timestamp = getCurrentTime();
            const entry = document.createElement('div');
            entry.className = 'log-entry';

            let icon = 'üí¨';
            let className = '';
            if (level === 'success') { icon = '‚úÖ'; className = 'success'; }
            else if (level === 'error') { icon = '‚ùå'; className = 'error'; }
            else if (level === 'warning') { icon = '‚ö†Ô∏è'; className = 'warning'; }
            else if (level === 'system') { icon = 'üîß'; className = 'info'; }

            entry.innerHTML = `<span class="timestamp">[${timestamp}]</span><span class="${className}">${icon} ${message}</span>`;
            logs.insertBefore(entry, logs.firstChild);

            // Keep only last 20 logs
            while (logs.children.length > 20) {
                logs.removeChild(logs.lastChild);
            }
        }

        async function checkCoordinator() {
            try {
                const response = await fetch(`${COORDINATOR_URL}/health`);
                if (response.ok) {
                    document.getElementById('coordinatorStatus').innerHTML = '<span class="success">‚óè ONLINE</span>';
                    return true;
                } else {
                    throw new Error('Not responding');
                }
            } catch (error) {
                document.getElementById('coordinatorStatus').innerHTML = '<span class="error">‚óè OFFLINE</span>';
                return false;
            }
        }

        async function updateInstances() {
            try {
                const response = await fetch(`${COORDINATOR_URL}/instances`);
                if (!response.ok) throw new Error('Coordinator offline');

                const instances = await response.json();
                const grid = document.getElementById('instances-grid');
                grid.innerHTML = '';

                let onlineCount = 0;
                let totalCount = 0;

                for (const [id, inst] of Object.entries(instances)) {
                    totalCount++;
                    if (inst.status === 'online') onlineCount++;

                    const card = document.createElement('div');
                    card.className = `instance-card ${inst.status}`;

                    const statusClass = `status-${inst.status}`;
                    const statusText = inst.status.toUpperCase();

                    card.innerHTML = `
                        <div class="instance-name">${inst.name}</div>
                        <span class="instance-status ${statusClass}">${statusText}</span>
                        <div class="instance-info">
                            <div><strong>Role:</strong> ${inst.role}</div>
                            <div><strong>Specialty:</strong> ${inst.specialty}</div>
                            ${inst.response_time ? `<div><strong>Response:</strong> ${inst.response_time}ms</div>` : ''}
                            ${inst.current_task ? `<div><strong>Task:</strong> ${inst.current_task}</div>` : ''}
                        </div>
                    `;
                    grid.appendChild(card);
                }

                document.getElementById('instances-online').textContent = `${onlineCount}/${totalCount}`;

            } catch (error) {
                console.error('Failed to update instances:', error);
            }
        }

        async function updateStats() {
            try {
                const response = await fetch(`${COORDINATOR_URL}/`);
                if (!response.ok) throw new Error('Coordinator offline');

                const data = await response.json();
                document.getElementById('health-checks').textContent = data.total_health_checks || 0;
                document.getElementById('total-messages').textContent = data.total_messages || 0;
                document.getElementById('total-tasks').textContent = data.total_tasks || 0;

            } catch (error) {
                console.error('Failed to update stats:', error);
            }
        }

        async function updateMessages() {
            try {
                const response = await fetch(`${COORDINATOR_URL}/messages?limit=10`);
                if (!response.ok) return;

                const data = await response.json();
                const logs = document.getElementById('logs');
                logs.innerHTML = '';

                data.messages.reverse().forEach(msg => {
                    const entry = document.createElement('div');
                    entry.className = 'log-entry';
                    const time = new Date(msg.timestamp).toLocaleTimeString();
                    const content = msg.content || JSON.stringify(msg);
                    entry.innerHTML = `<span class="timestamp">[${time}]</span><span>${content}</span>`;
                    logs.appendChild(entry);
                });

            } catch (error) {
                // Coordinator offline, use default logs
            }
        }

        async function syncNow() {
            addLog('Manual sync initiated...', 'system');
            addLog('Pulling from GitHub...', 'info');

            // Try to trigger actual sync if coordinator is running
            // For now, just inform user
            setTimeout(() => {
                addLog('Git sync happens automatically every 5 minutes', 'info');
                addLog('Or run: cd /home/user/100x-platform && git pull', 'info');
                document.getElementById('lastSync').textContent = getCurrentTime();
            }, 1000);
        }

        function openDetailedDashboard() {
            window.open('http://localhost:8900/dashboard', '_blank');
        }

        function startCoordinator() {
            addLog('To start coordinator, run:', 'info');
            addLog('cd /home/user/100x-platform', 'info');
            addLog('./START_COORDINATION.sh', 'success');

            // Try to open in new window anyway
            setTimeout(() => {
                window.open('http://localhost:8900/dashboard', '_blank');
            }, 2000);
        }

        function contactC2() {
            addLog('Attempting to contact C2 (The Architect)...', 'system');
            addLog('C2 should check: coordination/COMPUTER_2.md', 'info');
            addLog('Messages for C2: coordination/messages/1_TO_2.md', 'info');
        }

        function contactC3() {
            addLog('Attempting to contact C3 (The Oracle)...', 'system');
            addLog('C3 should check: coordination/COMPUTER_3.md', 'info');
            addLog('Messages for C3: coordination/messages/1_TO_3.md', 'info');
        }

        // Initialize
        async function init() {
            addLog('Trinity Central Command Dashboard loaded', 'success');

            const coordinatorOnline = await checkCoordinator();

            if (coordinatorOnline) {
                addLog('Local Instance Coordinator detected', 'success');
                updateInstances();
                updateStats();
                updateMessages();

                // Auto-refresh every 5 seconds
                setInterval(() => {
                    updateInstances();
                    updateStats();
                    updateMessages();
                }, 5000);
            } else {
                addLog('Local Instance Coordinator is OFFLINE', 'error');
                addLog('Start it with: ./START_COORDINATION.sh', 'warning');
            }
        }

        // Start
        init();

        console.log('‚ö° TRINITY CENTRAL COMMAND ONLINE ‚ö°');
        console.log('Multi-tier coordination system ready');
    </script>
</body>
</html>
